# 班级积分管理系统 v2.0

## 功能概述

这是一个基于PySide6开发的班级积分管理系统，用于管理学生的积分记录、兑换记录和每日任务。

## 主要功能

### 1. 学生管理
- 添加、编辑、删除学生信息
- 支持CSV批量导入学生
- 显示学生当前积分

### 2. 积分记分
- 基于预设规则进行积分记录
- 支持正分和负分
- 实时更新学生积分

### 3. 兑换功能
- 独立的兑换规则管理
- 兑换记录单独存储
- 支持积分消耗记录

### 4. 每日任务
- 每日任务规则管理
- 批量选择学生进行任务记分
- 按日期记录任务完成情况

### 5. 历史记录查询
- 支持按时间范围查询
- 支持按学生、事件类型、规则筛选
- 导出查询结果为CSV

### 6. 积分排名
- 实时显示学生积分排名
- 支持时间范围筛选
- 默认显示当前周的积分变化

## 数据存储结构

### 文件组织
```
data/
├── students.csv              # 学生信息
├── score_rules.csv          # 积分规则
├── reward_rules.csv         # 兑换规则  
├── daily_task_rules.csv     # 每日任务规则
├── reward_events.csv        # 兑换记录
├── daily_task_events.csv    # 每日任务记录
└── score_events/            # 积分事件目录（按天存储）
    ├── score_events_2024-01-01.csv
    ├── score_events_2024-01-02.csv
    └── ...
```

### 数据格式

#### 学生信息 (students.csv)
```csv
student_id,name,current_score
2024001,张三,85
2024002,李四,92
```

#### 积分规则 (score_rules.csv)
```csv
rule_name,score_value
做操+1分,1
迟到-2分,-2
```

#### 兑换规则 (reward_rules.csv)
```csv
rule_name,score_cost
小奖品,10
大奖品,50
```

#### 每日任务规则 (daily_task_rules.csv)
```csv
task_name,score_value
完成作业,5
课堂发言,3
```

#### 积分事件 (score_events_YYYY-MM-DD.csv)
```csv
student_id,event_name,score_change,timestamp,event_type
2024001,做操+1分,1,2024-01-01 08:30:00,score
2024002,迟到-2分,-2,2024-01-01 08:35:00,score
```

#### 兑换记录 (reward_events.csv)
```csv
student_id,reward_name,score_cost,timestamp
2024001,小奖品,10,2024-01-01 15:30:00
```

#### 每日任务记录 (daily_task_events.csv)
```csv
student_id,task_name,score_value,timestamp
2024001,完成作业,5,2024-01-01 16:00:00
```

## 系统要求

- Python 3.8+
- PySide6
- Windows 10/11 (推荐)

## 安装和运行

1. 确保已安装Python 3.8或更高版本
2. 安装依赖：
   ```bash
   pip install PySide6
   ```
3. 运行程序：
   ```bash
   python main.py
   ```

## 主要改进 (v2.0)

1. **数据存储优化**：积分事件按天分文件存储，便于查找和管理
2. **功能分离**：兑换功能独立存储，不再混合在积分记录中
3. **每日任务**：新增每日任务功能，支持批量记分
4. **历史记录**：新增历史记录查询页面，支持多维度筛选
5. **时间处理**：默认积分计算时间改为当前周，用户筛选不保存
6. **界面优化**：采用选项卡式设置页面，界面更清晰

## 使用说明

### 初次使用
1. 启动程序后，先在"设置"页面添加学生信息
2. 设置积分规则、兑换规则和每日任务规则
3. 在相应页面进行记分、兑换和任务记录

### 日常使用
1. **记分**：在"记分"页面选择学生和规则进行积分记录
2. **兑换**：在"兑换"页面为学生进行积分兑换
3. **每日任务**：在"每日任务"页面批量记录学生任务完成情况
4. **查看排名**：在"主页"查看学生积分排名
5. **历史查询**：在"历史记录"页面查询和导出历史数据

## 注意事项

1. 数据文件自动保存在程序目录的`data`文件夹中
2. 建议定期备份`data`文件夹
3. CSV导入时请确保文件编码为UTF-8
4. 删除学生会同时删除其所有积分记录，请谨慎操作
